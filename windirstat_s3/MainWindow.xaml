<Window x:Class="windirstat_s3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:viewModels="clr-namespace:windirstat_s3.ViewModels"
        Title="WinDirStat S3" Height="600" Width="900">
    <Window.Resources>
        <HierarchicalDataTemplate DataType="{x:Type viewModels:DirectoryNodeViewModel}" ItemsSource="{Binding Children}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Name}"/>
            </StackPanel>
        </HierarchicalDataTemplate>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Perfil:" VerticalAlignment="Center"/>
            <ComboBox x:Name="ProfileComboBox" Width="150" Margin="5,0,0,0" SelectionChanged="ProfileComboBox_SelectionChanged"/>
            <TextBlock Text="Bucket:" Margin="10,0,0,0" VerticalAlignment="Center"/>
            <ComboBox x:Name="BucketComboBox" Width="150" Margin="5,0,0,0"/>
            <TextBlock Text="Ignorar Prefixos:" Margin="10,0,0,0" VerticalAlignment="Center"/>
            <TextBox x:Name="IgnorePrefixesTextBox" Width="150" Margin="5,0,0,0" ToolTip="Separe por vÃ­rgulas"/>
            <Button Content="Scan" Margin="10,0,0,0" Click="ScanButton_Click"/>
            <ProgressBar Width="100" Height="20" Margin="10,0,0,0" Minimum="0" Maximum="100" Value="{Binding ProgressPercent}"/>
            <TextBlock Text="{Binding ScanTime}" Margin="10,0,0,0" VerticalAlignment="Center"/>
            <Button x:Name="CancelButton" Content="Cancelar" Margin="10,0,0,0" Click="CancelButton_Click" IsEnabled="False"/>
            <Button Content="Export CSV" Margin="10,0,0,0" Click="ExportCsvButton_Click"/>
            <Button Content="Export JSON" Margin="5,0,0,0" Click="ExportJsonButton_Click"/>
        </StackPanel>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <TreeView x:Name="ResultTree" Grid.Column="0"
                      ItemsSource="{Binding RootNodes}"
                      SelectedItemChanged="ResultTree_SelectedItemChanged"/>

            <DataGrid Grid.Column="1" ItemsSource="{Binding SelectedNodeChildren}"
                      AutoGenerateColumns="False" IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTemplateColumn Header="Name" Width="200">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="Subtree Percent" Binding="{Binding SubtreePercent, StringFormat={}{0:P2}}"/>
                    <DataGridTextColumn Header="Percent" Binding="{Binding PercentOfTotal, StringFormat={}{0:P2}}"/>
                    <DataGridTextColumn Header="Size" Binding="{Binding Size}"/>
                    <DataGridTextColumn Header="Items" Binding="{Binding TotalItems}"/>
                    <DataGridTextColumn Header="Files" Binding="{Binding TotalFiles}"/>
                    <DataGridTextColumn Header="Subdirs" Binding="{Binding TotalSubdirs}"/>
                    <DataGridTextColumn Header="Last Change" Binding="{Binding LastModified, StringFormat={}{0:G}}"/>
                    <DataGridTextColumn Header="Attributes" Binding="{Binding Attributes}"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</Window>
